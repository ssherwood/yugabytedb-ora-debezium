CREATE TABLE customers
(
  customer_id     INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
  email_address   VARCHAR2(255 CHAR) NOT NULL,
  full_name       VARCHAR2(255 CHAR) NOT NULL
);

CREATE INDEX customers_name_i          ON customers   ( full_name );

ALTER TABLE customers ADD CONSTRAINT customers_pk PRIMARY KEY (customer_id);
ALTER TABLE customers ADD CONSTRAINT customers_email_u UNIQUE (email_address);

CREATE TABLE stores
(
  store_id            INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
  store_name          VARCHAR2(255 CHAR) NOT NULL,
  web_address         VARCHAR2(100 CHAR),
  physical_address    VARCHAR2(512 CHAR),
  latitude            NUMBER(9,6),
  longitude           NUMBER(9,6)
);

ALTER TABLE stores ADD CONSTRAINT stores_pk PRIMARY KEY (store_id);
ALTER TABLE stores ADD CONSTRAINT store_name_u UNIQUE (store_name);

CREATE TABLE products
(
  product_id           INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
  product_name         VARCHAR2(255 CHAR) NOT NULL,
  unit_price           NUMBER(10,2),
  product_desc         VARCHAR2(255 CHAR)
);

ALTER TABLE products ADD CONSTRAINT products_pk PRIMARY KEY (product_id);

CREATE TABLE orders
(
  order_id       INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
  order_tms      TIMESTAMP NOT NULL,
  customer_id    INTEGER NOT NULL,
  order_status   VARCHAR2(10 CHAR) NOT NULL,
  store_id       INTEGER NOT NULL
);

CREATE INDEX orders_customer_id_i      ON orders      ( customer_id );
CREATE INDEX orders_store_id_i         ON orders      ( store_id );

ALTER TABLE orders ADD CONSTRAINT orders_pk PRIMARY KEY (order_id);
ALTER TABLE orders ADD CONSTRAINT orders_customer_id_fk
   FOREIGN KEY (customer_id) REFERENCES customers (customer_id);
ALTER TABLE orders ADD CONSTRAINT  orders_status_c
                  CHECK ( order_status in ( 'CANCELLED','COMPLETE','OPEN','PAID','REFUNDED','SHIPPED'));
ALTER TABLE orders ADD CONSTRAINT orders_store_id_fk FOREIGN KEY (store_id)
   REFERENCES stores (store_id);

CREATE TABLE order_items
(
  order_id       INTEGER NOT NULL,
  line_item_id   INTEGER NOT NULL,
  product_id     INTEGER NOT NULL,
  unit_price     NUMBER(10,2) NOT NULL,
  quantity       INTEGER NOT NULL
);

ALTER TABLE order_items ADD CONSTRAINT order_items_pk PRIMARY KEY ( order_id, line_item_id );
ALTER TABLE order_items ADD CONSTRAINT order_items_order_id_fk
   FOREIGN KEY (order_id) REFERENCES orders (order_id);
ALTER TABLE order_items ADD CONSTRAINT order_items_product_id_fk
   FOREIGN KEY (product_id) REFERENCES products (product_id);
ALTER TABLE order_items ADD CONSTRAINT order_items_product_u UNIQUE ( product_id, order_id );


SET VERIFY OFF
SET DEFINE OFF
ALTER SESSION SET NLS_LANGUAGE=American;

BEGIN
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (1,'tammy.bryant@internalmail','Tammy Bryant');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (2,'roy.white@internalmail','Roy White');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (3,'gary.jenkins@internalmail','Gary Jenkins');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (4,'victor.morris@internalmail','Victor Morris');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (5,'beverly.hughes@internalmail','Beverly Hughes');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (6,'evelyn.torres@internalmail','Evelyn Torres');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (7,'carl.lee@internalmail','Carl Lee');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (8,'douglas.flores@internalmail','Douglas Flores');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (9,'norma.robinson@internalmail','Norma Robinson');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (10,'gregory.sanchez@internalmail','Gregory Sanchez');
  INSERT INTO customers (customer_id,email_address,full_name) VALUES (11,'thomas.malory@internalmail','Thomas Malory');
END;
/

BEGIN
  INSERT INTO products (product_id,product_name,unit_price,product_desc) VALUES (1,'Shirt',29.55,'Common tshirt');
  INSERT INTO products (product_id,product_name,unit_price,product_desc) VALUES (2,'Pants',49.55,'Common jeans');
  INSERT INTO products (product_id,product_name,unit_price,product_desc) VALUES (3,'Socks',9.55,'White socks');
END;
/

BEGIN
  INSERT INTO stores (store_id,store_name,web_address) VALUES (1,'Online','https://www.example.com');
  INSERT INTO stores (store_id,store_name,physical_address,latitude,longitude) VALUES (2,'San Francisco','Redwood Shores
    500 Oracle Parkway
    Redwood Shores, CA 94065',37.529395,-122.267237);
  INSERT INTO stores (store_id,store_name,physical_address,latitude,longitude) VALUES (3,'Seattle','1501 Fourth Avenue
    Suite 1800
    Seattle, WA 98101',47.6053,-122.33221);
END;
/

BEGIN
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (1,TO_TIMESTAMP('04-FEB-2021 13.20.22.245676861','DD-MON-YYYY HH24.MI.SS.FF'),1,1,'CANCELLED');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (2,TO_TIMESTAMP('08-FEB-2021 20.58.10.472721115','DD-MON-YYYY HH24.MI.SS.FF'),2,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (3,TO_TIMESTAMP('09-FEB-2021 23.17.07.242517323','DD-MON-YYYY HH24.MI.SS.FF'),3,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (4,TO_TIMESTAMP('10-FEB-2021 13.43.36.061928731','DD-MON-YYYY HH24.MI.SS.FF'),4,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (5,TO_TIMESTAMP('11-FEB-2021 18.01.30.906119035','DD-MON-YYYY HH24.MI.SS.FF'),5,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (6,TO_TIMESTAMP('13-FEB-2021 20.11.48.702319539','DD-MON-YYYY HH24.MI.SS.FF'),6,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (7,TO_TIMESTAMP('22-FEB-2021 00.57.11.011114421','DD-MON-YYYY HH24.MI.SS.FF'),7,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (8,TO_TIMESTAMP('22-FEB-2021 15.00.52.003836100','DD-MON-YYYY HH24.MI.SS.FF'),8,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (9,TO_TIMESTAMP('23-FEB-2021 13.25.26.824165229','DD-MON-YYYY HH24.MI.SS.FF'),9,1,'COMPLETE');
  INSERT INTO orders (order_id,order_tms,customer_id,store_id,order_status) VALUES (10,TO_TIMESTAMP('23-FEB-2021 14.02.10.185866897','DD-MON-YYYY HH24.MI.SS.FF'),10,1,'COMPLETE');
END;
/

BEGIN
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (1,1,1,37,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (1,2,2,30.69,2);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (2,1,1,8.66,3);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (2,2,2,5.65,5);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (3,1,3,8.66,5);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (4,1,1,28.21,2);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (4,2,2,22.98,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (4,3,3,39.16,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (5,1,1,34.06,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (5,2,2,5.65,3);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (6,1,1,38.28,3);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (6,2,2,21.16,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (7,1,1,49.12,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (7,2,2,24.71,1);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (8,1,1,49.12,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (8,2,2,22.98,4);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (8,3,3,27.64,1);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (9,1,1,13.97,5);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (9,2,2,5.65,2);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (10,1,1,39.91,3);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (10,2,2,23.32,5);
  INSERT INTO order_items (order_id,line_item_id,product_id,unit_price,quantity) VALUES (10,3,3,43.71,3);
END;
/

COMMIT;

exit;
